<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALKY | My Profile</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <style>
        .profile-section {
            padding: 8rem 5%;
            max-width: 1100px;
            margin: 0 auto;
            background: #fff;
            color: #111;
        }

        /* HEADER */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 4rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #ddd;
        }

        .avatar-circle {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: #111;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Bebas Neue';
            font-size: 3rem;
            letter-spacing: 1px;
        }

        .user-info h1 {
            font-family: 'Bebas Neue';
            font-size: 3rem;
            margin-bottom: 0.3rem;
            color: #000;
        }

        .user-info p {
            font-size: 1rem;
            color: #666;
        }

        /* ORDERS */
        .orders-title {
            font-family: 'Bebas Neue';
            font-size: 2.2rem;
            margin-bottom: 2rem;
            letter-spacing: 2px;
            color: #000;
        }

        .order-card {
            background: #fafafa;
            border: 1px solid #e0e0e0;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.25s ease;
        }

        .order-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        }

        /* ORDER HEADER */
        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e5e5;
        }

        .order-id {
            font-weight: 700;
            color: #000;
            letter-spacing: 1px;
        }

        .order-date {
            font-size: 0.85rem;
            color: #777;
        }

        /* ITEMS */
        .order-items {
            display: flex;
            gap: 0.8rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .order-item-img {
            width: 55px;
            height: 55px;
            object-fit: cover;
            border-radius: 3px;
            filter: grayscale(100%);
            opacity: 0.9;
        }

        /* TOTAL */
        .order-total {
            text-align: right;
            font-weight: 700;
            font-size: 1.1rem;
            margin-top: 1rem;
            color: #000;
        }

        /* DARK MODE (если используешь) */
        [data-theme="dark"] .profile-section {
            background: #0f0f0f;
            color: #eee;
        }

        [data-theme="dark"] .order-card {
            background: #1a1a1a;
            border-color: #333;
        }

        [data-theme="dark"] .order-id,
        [data-theme="dark"] .orders-title {
            color: #fff;
        }

        [data-theme="dark"] .order-date,
        [data-theme="dark"] .user-info p {
            color: #aaa;
        }

    </style>
</head>
<body>

<!-- Вставь сюда тот же <nav> что и в index.html -->
<nav>
    <div class="logo"><a href="index.html" style="text-decoration:none; color:inherit;">ALKY</a></div>
    <div class="burger-menu" id="burger-menu">
        <div class="line1"></div><div class="line2"></div><div class="line3"></div>
    </div>
    <ul class="nav-links" id="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="catalog.html">Collection</a></li>
        <li><a href="#" id="logout-btn-profile" style="color: var(--secondary);">Logout</a></li>
    </ul>
</nav>

<section class="profile-section">
    <!-- JS заполнит это -->
    <div class="profile-header">
        <div class="avatar-circle" id="user-avatar">?</div>
        <div class="user-info">
            <h1 id="profile-name">Loading...</h1>
            <p id="profile-email">...</p>
        </div>
    </div>

    <h2 class="orders-title">MY ORDER HISTORY</h2>
    <div id="orders-container">
        <!-- Сюда попадут заказы -->
        <p>Loading orders...</p>
    </div>
</section>

<script src="js/main.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const userStr = localStorage.getItem('currentUser');
        if(!userStr) {
            window.location.href = 'auth.html';
            return;
        }

        const user = JSON.parse(userStr);

        // 1. Заполняем шапку
        document.getElementById('profile-name').textContent = user.name;
        document.getElementById('profile-email').textContent = user.email;
        document.getElementById('user-avatar').textContent = user.name.charAt(0).toUpperCase();

        // 2. Получаем историю заказов
        const orders = JSON.parse(localStorage.getItem(`orders_${user.email}`)) || [];
        const container = document.getElementById('orders-container');
        container.innerHTML = '';

        if(orders.length === 0) {
            container.innerHTML = '<p>You haven\'t placed any orders yet.</p>';
        } else {
            // Показываем новые сверху (reverse)
            orders.reverse().forEach(order => {
                let itemsHtml = '';
                order.items.forEach(item => {
                    itemsHtml += `<img src="${item.image}" class="order-item-img" title="${item.title}">`;
                });

                const card = document.createElement('div');
                card.className = 'order-card';
                card.innerHTML = `
                        <div class="order-header">
                            <span class="order-id">ORDER ${order.id}</span>
                            <span class="order-date">${order.date}</span>
                        </div>
                        <div class="order-items">
                            ${itemsHtml}
                        </div>
                        <div class="order-total">
                            TOTAL: $${order.total.toFixed(2)}
                        </div>
                    `;
                container.appendChild(card);
            });
        }

        // Logout specific for this page
        document.getElementById('logout-btn-profile').addEventListener('click', (e) => {
            e.preventDefault();
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        });
    });
</script>
</body>
</html>
